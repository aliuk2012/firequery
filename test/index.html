<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <script type="text/javascript" charset="utf-8">
        (function() {
            // parseUri 1.2.2
            // (c) Steven Levithan <stevenlevithan.com>
            // MIT License
            function parseUri (str) {
                var o   = parseUri.options,
                    m   = o.parser[o.strictMode ? "strict" : "loose"].exec(str),
                    uri = {},
                    i   = 14;

                while (i--) uri[o.key[i]] = m[i] || "";

                uri[o.q.name] = {};
                uri[o.key[12]].replace(o.q.parser, function ($0, $1, $2) {
                    if ($1) uri[o.q.name][$1] = $2;
                });

                return uri;
            };

            parseUri.options = {
                strictMode: false,
                key: ["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],
                q:   {
                    name:   "queryKey",
                    parser: /(?:^|&)([^&=]*)=?([^&]*)/g
                },
                parser: {
                    strict: /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
                    loose:  /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/
                }
            };

            var query = parseUri(location+"");
            var v = '1.10.2'; // default
            if (query && query.queryKey && query.queryKey['v']) {
                v = query.queryKey['v'];
            }
            if (v!='none') {
                try {
                    var oHead = document.getElementsByTagName('HEAD').item(0);
                    var oScript= document.createElement("script");
                    oScript.type = "text/javascript";
                    oScript.src="http://code.jquery.com/jquery-"+v+".js";
                    oHead.appendChild(oScript);
                    window.selectedVersion = v;
                } catch (e) {
                    console.log("Unable to load jQuery %o from code.jquery.com: %o", v, e.message);
                }
            }
        })();
    </script>
    <style type="text/css" media="screen">
        html{font-family:arial;}
        .version-switcher{font-size:10px;background-color:#ccc;color:black;padding:6px 8px;font-weight:bold;}
        .version-switcher a{display:inline-block;color:#2C679C;background-color:#ddd;padding:1px 4px;-moz-border-radius:4px;-webkit-border-radius:4px;border:1px solid #ddd;}
        .version-switcher a.selected-version{background-color:#2C679C;color:white;padding:1px 4px;-moz-border-radius:4px;-webkit-border-radius:4px;border:1px solid #2C679C;}
        a.selected-version{color:white;}
        iframe {height:180px; border: 2px dashed #999; margin: 10px;}
        p { background-color: #eef;}
        .long-list li { float:left; margin-left: 10px; list-style-type: none;}
        h1 {background-color: #efe;cursor:pointer;}
        .list-box {background-color: #eff;}
    </style>
</head>
<body>
    <div class="controls">
        <div class="version-switcher">Test with jQuery:
            <a href="?v=1.2.3">1.2.3</a> |
            <a href="?v=1.2.6">1.2.6</a> |
            <a href="?v=1.3">1.3.0</a> |
            <a href="?v=1.3.1">1.3.1</a> |
            <a href="?v=1.3.2">1.3.2</a> |
            <a href="?v=1.4">1.4.0</a> |
            <a href="?v=1.4.1">1.4.1</a> |
            <a href="?v=1.4.2">1.4.2</a> |
            <a href="?v=1.4.3">1.4.3</a> |
            <a href="?v=1.4.4">1.4.4</a> |
            <a href="?v=1.5">1.5.0</a> |
            <a href="?v=1.5.1">1.5.1</a> |
            <a href="?v=1.5.2">1.5.2</a> |
            <a href="?v=1.6">1.6.0</a> |
            <a href="?v=1.6.1">1.6.1</a> |
            <a href="?v=1.6.2">1.6.2</a> |
            <a href="?v=1.6.3">1.6.3</a> |
            <a href="?v=1.6.4">1.6.4</a> |
            <a href="?v=1.7">1.7.0</a> |
            <a href="?v=1.7.1">1.7.1</a> |
            <a href="?v=1.7.2">1.7.2</a> |
            <a href="?v=1.8.0">1.8.0</a> |
            <a href="?v=1.8.1">1.8.1</a> |
            <a href="?v=1.8.2">1.8.2</a> |
            <a href="?v=1.8.3">1.8.3</a> |
            <a href="?v=1.9.0">1.9.0</a> |
            <a href="?v=1.9.1">1.9.1</a> |
            <a href="?v=1.10.0">1.10.0</a> |
            <a href="?v=1.10.1">1.10.1</a> |
            <a href="?v=1.10.2">1.10.2</a> |
            <a href="?v=2.0.0">2.0.0</a> |
            <a href="?v=2.0.1">2.0.1</a> |
            <a href="?v=2.0.2">2.0.2</a> |
            <a href="?v=2.0.3">2.0.3</a> or
            <a href="?v=none">none</a>
            <script type="text/javascript" charset="utf-8">
                if (!window.selectedVersion) {
                    var a = document.getElementsByClassName('version-switcher')[0].children;
                    var last = a[a.length-2]; // the last one is this <script>
                    last.className = 'selected-version';
                }
            </script>
        </div>
        <div class="buttons-bar">
            <button onclick="exercise()">Exercise!</button>
            <button onclick="$('h1').data('added-data', 'this value should appear as a mutation event '+new Date())">Add H1 data</button>
            <button onclick="$('h1').data('added-data', null)">Nullify H1 data</button>
            <button onclick="$('h1').removeData('added-data')">Remove H1 data</button>
        </div>
    </div>

    <h1>FireQuery test page</h1>
    <div id="header" class="box">
        <p>Hello from the header</p>
    </div>
    <iframe src="frame1.html"></iframe>
    <iframe src="frame2.html"></iframe>
    <div id="main" class="box">
        <p>Hello from the body</p>
    </div>
    <div id="footer" class="box">
        <p>Hello from the footer</p>
        <div class="list-box">
            Here is some long list
            <ul class="long-list">
                <li>01</li><li>02</li><li>03</li><li>04</li><li>05</li><li>06</li><li>07</li><li>08</li><li>09</li><li>10</li>
                <li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li><li>19</li><li>20</li>
                <li>21</li><li>22</li><li>23</li><li>24</li><li>25</li><li>26</li><li>27</li><li>28</li><li>29</li><li>30</li>
            </ul>
            <div style="clear:both"></div>
        </div>
    </div>
    <script type="text/javascript">
        function exercise() {
            $('h1').append(' - jQuery ' + $.fn.jquery);
            console.warn('Simon says: "Do some exercise with jQuery v' + $.fn.jquery + '"');
            $('body').data('Firebug', 'makes it possible').data('jQuery', "is pretty damn cool!").data('FireQuery', 'is just a cherry');

            $('h1').bind('click', function() {
                $(this).css('background-color', '#fee');
            });
            $('p').data('hasData', 'yeah!');
            $('iframe').eq(0).data('framedata', 1);
            $('iframe').eq(1).data('framedata', 2);
            $('#main').data('something more complex', {
                structured: "yep!",
                arr: [1, 2, 3],
                fn: function(a, b) {},
                nool: null,
                undef: undefined
            });
            console.log($('body'));
            console.log($('.box'));
            console.log($('#footer ul'));
            console.log($('p'));
            console.log($('li'));
            console.log($('#nonsense'));

            var counter = 0;
            setInterval(function() {
              $.data($('body').get(0), 'counter', counter++);
            }, 1000);
            setInterval(function() {
              $('p').data('hexCounter', counter.toString(16));
            }, 3000);
        }

        function onReady() {
            try {
                var version = $.fn.jquery;
                if (version.length==3) version += ".0";
                $('.version-switcher a.selected-version').removeClass('selected-version');
                $('.version-switcher a:contains(\''+version+'\')').addClass('selected-version');
            } catch(e) {}
            if (window.selectedVersion) {
                exercise();
            }
        }

        // we are loading jQuery by dynamic script tag insertion, wait here for async load
        var interval = setInterval(function() {
            if (typeof $ != "undefined") {
                clearInterval(interval);
                onReady();
            }
        }, 200);

    </script>
</body>
</html>
